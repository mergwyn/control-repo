---

classes:
  - role::lxd_server
  - role::backup_server
  - role::file_server

#- profile::domain_sso
#- nginx
#- network
#- profile::lxd_host

#unattended_upgrades:
#  stable:
#      origin:                   'Jamie Cameron'

network::interfaces_hash:
  enp3s0:
    method:                     manual
    pre_up:
      - /sbin/ifconfig enp3s0 mtu 9004
  enp4s0:
    method:                     manual
    pre_up:
      - /sbin/ifconfig enp4s0 mtu 9004
  br0:
    ipaddress:                  "192.168.11.12"
    netmask:                    "%{hiera('defaults::netmask')}"
    gateway:                    "%{hiera('defaults::gateway')}"
    network:                    "%{hiera('defaults::network')}"
    dns_nameservers:            "%{hiera('defaults::dns_nameservers')}"
    dns_search:                 "%{hiera('defaults::dns_search')}"
    bridge_ports:
      - enp3s0
      - enp4s0
    bridge_maxwait:             "0"
    bridge_fd:                  "0"
    bridge_stp:                 "off"

nginx::nginx_vhosts:
  'backuppc':
    server_name:                [ 'foxtrot.theclarkhome.com' ]
    listen_port:                80
nginx::nginx_locations:
  '/backuppc':
    vhost:                      'backuppc'
    auth_basic:                 "BackupPC admin"
    auth_basic_user_file:       "/etc/backuppc/htpasswd"
    www_root:                   "/usr/share/backuppc/cgi-bin"
    index_files:                [ "/index.cgi" ]
  'cgi':
    vhost:                      'backuppc'
    location:                   '~\.cgi$'
    fastcgi:                    'unix:/var/run/fcgiwrap.socket'
    fastcgi_script:             "/usr/share/backuppc/cgi-bin$fastcgi_script_name"
    www_root:                   '/tmp/'
    #gzip_vary:                 'off'
    location_cfg_append:
      include:                  '/etc/nginx/fastcgi_params'
      fastcgi_index:            'BackupPC_Admin'
      #fastcgi_param SCRIPT_FILENAME:   "/usr/share/backuppc/cgi-bin$fastcgi_script_name"

---
# vim: sw=2:ai:nu expandtab
