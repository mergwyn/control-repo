---

classes:
  - profile::base::dism

#profile::base::dism::objects:
#  Microsoft-Windows-Subsystem-Linux: 
#    norestart: true

profile::base::packages::objects:
  rsat:
    install_options:
      - '-params'
      - '"'
      - '/AD'
      - '/GP'
      - '/DNS'
      - '"'
#  wsl:  
#    notify: Reboot[after]
#  wsl-ubuntu-1804:
  wsl-ubuntu-1804: {}
#    require: 
#    - Package[wsl]
#    - Reboot[before]


profile::base::tasks::defaults:
  ensure: present
  enabled: true
profile::base::tasks::objects:
  'GPO Backup':
    command: 'powershell.exe'
    arguments: "-ExecutionPolicy RemoteSigned \\\\%{hiera('defaults::backup_server')}\\backup\\GPO\\GPOBackup.ps1"
    working_dir: "\\\\%{hiera('defaults::backup_server')}\\backup\\%{trusted.host}\\GPO\\"
    user: "%{hiera(defaults::workgroup')}\\backup"
    password: "%{hiera('secrets::backup')}"
    trigger:
      schedule: 'daily'
      start_time: '02:30'

# vim: sw=2:ai:nu expandtab
