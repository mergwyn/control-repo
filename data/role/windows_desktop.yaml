---

#profile::os::windows::dism::objects:
#  Microsoft-Windows-Subsystem-Linux: 
#    norestart: true

profile::base::packages::objects:
  rsat:
    install_options:
      - '-params'
      - '"'
      - '/AD'
      - '/GP'
      - '/DNS'
      - '"'
#  wsl:  
#    notify: Reboot[after]
#  wsl-ubuntu-1804:
  wsl-ubuntu-1804: {}
#    require: 
#    - Package[wsl]
#    - Reboot[before]


profile::os::windows::tasks::defaults:
  ensure: present
  enabled: true
profile::os::windows::tasks::objects:
  'GPO Backup':
    command: "%{::system32}\\WindowsPowerShell\\v1.0\\powershell.exe"
    arguments: "-ExecutionPolicy RemoteSigned \\\\%{lookup('defaults::backup_server')}\\backup\\GPO\\GPOBackup.ps1"
    working_dir: "\\\\%{lookup('defaults::backup_server')}\\backup\\%{trusted.hostname}\\GPO\\"
    user: "%{lookup('defaults::workgroup')}\\backup"
    password: "%{lookup('secrets::backup')}"
    trigger:
      schedule: 'daily'
      start_time: '02:30'

